<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>C:\Users\User\git\fbbot\node_modules\botkit\.readme-facebook.md.html</title>


<style type="text/css">
body {
	color: #333;
	font: 13px/1.4 "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
	padding: 0;
	margin: 0;
}

a {
	background: transparent;
	color: #4183c4;
	text-decoration: none;
}

a:active,
a:hover {
	outline: 0 none;
	text-decoration: underline;
}

abbr[title] {
	border-bottom: 1px dotted;
}

b,
strong {
	font-weight: bold;
}

dfn {
	font-style: italic;
}
h1 {
	font-size: 2em;
	margin: 0.67em 0;
}
mark {
	background: #ff0;
	color: #000;
}
small {
	font-size: 80%;
}
sub, sup {
	font-size: 75%;
	line-height: 0;
	position: relative;
	vertical-align: baseline;
}
sup {
	top: -0.5em;
}
sub {
	bottom: -0.25em;
}
img {
	border: 0 none;
}
svg:not(:root) {
	overflow: hidden;
}
figure {
	margin: 1em 40px;
}
hr {
	box-sizing: content-box;
	height: 0;
}

code,
kbd,
pre,
samp {
	font-family: monospace,monospace;
	font-size: 1em;
}

pre {
	overflow: auto;
	font: 12px Consolas,"Liberation Mono",Menlo,Courier,monospace;
	margin-bottom: 0;
	margin-top: 0;
}

.markdown-body {
	padding: 30px;
	font-size: 16px;
	line-height: 1.6;
	word-wrap: break-word;
}

.markdown-body>*:first-child {
	margin-top: 0 !important;
}

.markdown-body>*:last-child {
	margin-bottom: 0 !important;
}

.markdown-body .absent {
	color: #c00;
}

.markdown-body .anchor {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	display: block;
	padding-right: 6px;
	padding-left: 30px;
	margin-left: -30px;
}

.markdown-body .anchor:focus {
	outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
	position: relative;
	margin-top: 1em;
	margin-bottom: 16px;
	font-weight: bold;
	line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
	display: none;
	color: #000;
	vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
	padding-left: 8px;
	margin-left: -30px;
	line-height: 1;
	text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
	display: inline-block;
}

.markdown-body h1 tt,
.markdown-body h1 code,
.markdown-body h2 tt,
.markdown-body h2 code,
.markdown-body h3 tt,
.markdown-body h3 code,
.markdown-body h4 tt,
.markdown-body h4 code,
.markdown-body h5 tt,
.markdown-body h5 code,
.markdown-body h6 tt,
.markdown-body h6 code {
	font-size: inherit;
}

.markdown-body h1 {
	padding-bottom: 0.3em;
	font-size: 2.25em;
	line-height: 1.2;
	border-bottom: 1px solid #eee;
}

.markdown-body h2 {
	padding-bottom: 0.3em;
	font-size: 1.75em;
	line-height: 1.225;
	border-bottom: 1px solid #eee;
}

.markdown-body h3 {
	font-size: 1.5em;
	line-height: 1.43;
}

.markdown-body h4 {
	font-size: 1.25em;
}

.markdown-body h5 {
	font-size: 1em;
}

.markdown-body h6 {
	font-size: 1em;
	color: #777;
}

.markdown-body p,.markdown-body blockquote,
.markdown-body ul,.markdown-body ol,
.markdown-body dl,.markdown-body table,
.markdown-body pre {
	margin-top: 0;
	margin-bottom: 16px;
}

.markdown-body hr {
	height: 4px;
	padding: 0;
	margin: 16px 0;
	background-color: #e7e7e7;
	border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
	padding-left: 2em;
}

.markdown-body ul.no-list,
.markdown-body ol.no-list {
	padding: 0;
	list-style-type: none;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body li>p {
	margin-top: 16px;
}

.markdown-body dl {
	padding: 0;
}

.markdown-body dl dt {
	padding: 0;
	margin-top: 16px;
	font-size: 1em;
	font-style: italic;
	font-weight: bold;
}

.markdown-body dl dd {
	padding: 0 16px;
	margin-bottom: 16px;
}

.markdown-body blockquote {
	padding: 0 15px;
	color: #777;
	border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
	margin-top: 0;
}

.markdown-body blockquote>:last-child {
	margin-bottom: 0;
}

.markdown-body table {
	display: block;
	width: 100%;
	overflow: auto;
	word-break: normal;
	word-break: keep-all;
}

.markdown-body table th {
	font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
	padding: 6px 13px;
	border: 1px solid #ddd;
}

.markdown-body table tr {
	background-color: #fff;
	border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
	background-color: #f8f8f8;
}

.markdown-body img {
	max-width: 100%;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}

.markdown-body span.frame {
	display: block;
	overflow: hidden;
}

.markdown-body span.frame>span {
	display: block;
	float: left;
	width: auto;
	padding: 7px;
	margin: 13px 0 0;
	overflow: hidden;
	border: 1px solid #ddd;
}

.markdown-body span.frame span img {
	display: block;
	float: left;
}

.markdown-body span.frame span span {
	display: block;
	padding: 5px 0 0;
	clear: both;
	color: #333;
}

.markdown-body span.align-center {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-center>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: center;
}

.markdown-body span.align-center span img {
	margin: 0 auto;
	text-align: center;
}

.markdown-body span.align-right {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-right>span {
	display: block;
	margin: 13px 0 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body span.align-right span img {
	margin: 0;
	text-align: right;
}

.markdown-body span.float-left {
	display: block;
	float: left;
	margin-right: 13px;
	overflow: hidden;
}

.markdown-body span.float-left span {
	margin: 13px 0 0;
}

.markdown-body span.float-right {
	display: block;
	float: right;
	margin-left: 13px;
	overflow: hidden;
}

.markdown-body span.float-right>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body code,.markdown-body tt {
	padding: 0;
	padding-top: 0.2em;
	padding-bottom: 0.2em;
	margin: 0;
	font-size: 85%;
	background-color: rgba(0,0,0,0.04);
	border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after,
.markdown-body tt:before,
.markdown-body tt:after {
	letter-spacing: -0.2em;
	content: "\00a0";
}

.markdown-body code br,
.markdown-body tt br {
	display: none;
}

.markdown-body del code {
	text-decoration: inherit;
}

.markdown-body pre>code {
	padding: 0;
	margin: 0;
	font-size: 100%;
	word-break: normal;
	white-space: pre;
	background: transparent;
	border: 0;
}

.markdown-body .highlight {
	margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
	padding: 16px;
	overflow: auto;
	font-size: 85%;
	line-height: 1.45;
	background-color: #f7f7f7;
	border-radius: 3px;
}

.markdown-body .highlight pre {
	margin-bottom: 0;
	word-break: normal;
}

.markdown-body pre {
	word-wrap: normal;
}

.markdown-body pre code,
.markdown-body pre tt {
	display: inline;
	max-width: initial;
	padding: 0;
	margin: 0;
	overflow: initial;
	line-height: inherit;
	word-wrap: normal;
	background-color: transparent;
	border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after,
.markdown-body pre tt:before,
.markdown-body pre tt:after {
	content: normal;
}

.highlight .pl-coc,
.highlight .pl-entl,
.highlight .pl-entm,
.highlight .pl-eoa,
.highlight .pl-mai .pl-sf,
.highlight .pl-mm,
.highlight .pl-pdv,
.highlight .pl-sc,
.highlight .pl-som,
.highlight .pl-sr,
.highlight .pl-v,
.highlight .pl-vpf {
	color: #0086b3;
}
.highlight .pl-eoac,
.highlight .pl-mdht,
.highlight .pl-mi1,
.highlight .pl-mri,
.highlight .pl-va,
.highlight .pl-vpu {
	color: #008080;
}
.highlight .pl-c,
.highlight .pl-pdc {
	color: #b4b7b4;
	font-style: italic;
}
.highlight .pl-k,
.highlight .pl-ko,
.highlight .pl-kolp,
.highlight .pl-mc,
.highlight .pl-mr,
.highlight .pl-ms,
.highlight .pl-s,
.highlight .pl-sok,
.highlight .pl-st {
	color: #6e5494;
}
.highlight .pl-ef,
.highlight .pl-enf,
.highlight .pl-enm,
.highlight .pl-entc,
.highlight .pl-eoi,
.highlight .pl-sf,
.highlight .pl-smc {
	color: #d12089;
}
.highlight .pl-ens,
.highlight .pl-eoai,
.highlight .pl-kos,
.highlight .pl-mh .pl-pdh,
.highlight .pl-mp,
.highlight .pl-pde,
.highlight .pl-stp {
	color: #458;
}
.highlight .pl-enti {
	color: #d12089;
	font-weight: bold;
}
.highlight .pl-cce,
.highlight .pl-enc,
.highlight .pl-kou,
.highlight .pl-mq {
	color: #f93;
}
.highlight .pl-mp1 .pl-sf {
	color: #458;
	font-weight: bold;
}
.highlight .pl-cos,
.highlight .pl-ent,
.highlight .pl-md,
.highlight .pl-mdhf,
.highlight .pl-ml,
.highlight .pl-pdc1,
.highlight .pl-pds,
.highlight .pl-s1,
.highlight .pl-scp,
.highlight .pl-sol {
	color: #df5000;
}
.highlight .pl-c1,
.highlight .pl-cn,
.highlight .pl-pse,
.highlight .pl-pse .pl-s2,
.highlight .pl-vi {
	color: #a31515;
}
.highlight .pl-mb,
.highlight .pl-pdb {
	color: #df5000;
	font-weight: bold;
}
.highlight .pl-mi,
.highlight .pl-pdi {
	color: #6e5494;
	font-style: italic;
}
.highlight .pl-ms1 {
	background-color: #f5f5f5;
}
.highlight .pl-mdh,
.highlight .pl-mdi {
	font-weight: bold;
}
.highlight .pl-mdr {
	color: #0086b3;
	font-weight: bold;
}
.highlight .pl-s2 {
	color: #333;
}
.highlight .pl-ii {
	background-color: #df5000;
	color: #fff;
}
.highlight .pl-ib {
	background-color: #f93;
}
.highlight .pl-id {
	background-color: #a31515;
	color: #fff;
}
.highlight .pl-iu {
	background-color: #b4b7b4;
}
.highlight .pl-mo {
	color: #969896;
}

</style>


<script type="text/javascript">

function getDocumentScrollTop() 
{
   var res = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset || 0;
   // alert(res);
   return res;
}

function setDocumentScrollTop(ypos) 
{
	window.scrollTo(0, ypos);
}

</script>


</head>
<body class="markdown-body">
<h1> <a id="user-content-botkit-and-facebook" class="anchor" href="#botkit-and-facebook" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Botkit and Facebook</h1> 
<p>Botkit is designed to ease the process of designing and running useful, creative bots that live inside <a href="http://slack.com">Slack</a>, <a href="http://facebook.com">Facebook Messenger</a>, <a href="https://www.twilio.com/docs/api/ip-messaging">Twilio IP Messaging</a>, and other messaging platforms.</p> 
<p>Botkit features a comprehensive set of tools to deal with <a href="https://developers.facebook.com/docs/messenger-platform/implementation">Facebooks's Messenger platform</a>, and allows developers to build interactive bots and applications that send and receive messages just like real humans. Facebook bots can be connected to Facebook Pages, and can be triggered using a variety of <a href="https://developers.facebook.com/docs/messenger-platform/plugin-reference">useful web plugins</a>.</p> 
<p>This document covers the Facebook-specific implementation details only. <a href=".readme.md.html">Start here</a> if you want to learn about to develop with Botkit.</p> 
<p>Table of Contents</p> 
<ul> 
 <li><a href="#getting-started">Getting Started</a></li> 
 <li><a href="#facebook-specific-events">Facebook-specific Events</a></li> 
 <li><a href="#working-with-facebook-messenger">Working with Facebook Webhooks</a></li> 
 <li><a href="#using-structured-messages-and-postbacks">Using Structured Messages and Postbacks</a></li> 
</ul> 
<h2> <a id="user-content-getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting Started</h2> 
<p>1) Install Botkit <a href=".readme.md.html#installation">more info here</a></p> 
<p>2) Create a <a href="https://developers.facebook.com/quickstarts/?platform=web">Facebook App for Web</a> and note down or <a href="https://www.facebook.com/pages/create/">create a new Facebook Page</a>. Your Facebook page will be used for the app's identity.</p> 
<p>3) <a href="https://developers.facebook.com/docs/messenger-platform/implementation#page_access_token">Get a page access token for your app</a></p> 
<p>Copy this token, you'll need it!</p> 
<p>4) Define your own &quot;verify token&quot; - this a string that you control that Facebook will use to verify your web hook endpoint.</p> 
<p>5) Run the example bot app, using the two tokens you just created. If you are <em>not</em> running your bot at a public, SSL-enabled internet address, use the --lt option and note the URL it gives you.</p> 
<pre><code>page_token=&lt;MY PAGE TOKEN&gt; verify_token=&lt;MY_VERIFY_TOKEN&gt; node facebook_bot.js [--lt [--ltsubdomain CUSTOM_SUBDOMAIN]]
</code></pre> 
<p>6) <a href="https://developers.facebook.com/docs/messenger-platform/implementation#setting_webhooks">Set up a webhook endpoint for your app</a> that uses your public URL. Use the verify token you defined in step 4!</p> 
<p>7) Your bot should be online! Within Facebook, find your page, and click the &quot;Message&quot; button in the header.</p> 
<p>Try:</p> 
<ul> 
 <li>who are you?</li> 
 <li>call me Bob</li> 
 <li>shutdown</li> 
</ul> 
<h3> <a id="user-content-things-to-note" class="anchor" href="#things-to-note" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Things to note</h3> 
<p>Since Facebook delivers messages via web hook, your application must be available at a public internet address. Additionally, Facebook requires this address to use SSL. Luckily, you can use <a href="https://localtunnel.me/">LocalTunnel</a> to make a process running locally or in your dev environment available in a Facebook-friendly way.</p> 
<p>When you are ready to go live, consider <a href="http://letsencrypt.org">LetsEncrypt.org</a>, a <em>free</em> SSL Certificate Signing Authority which can be used to secure your website very quickly. It is fabulous and we love it.</p> 
<h2> <a id="user-content-facebook-specific-events" class="anchor" href="#facebook-specific-events" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Facebook-specific Events</h2> 
<p>Once connected to Facebook, bots receive a constant stream of events.</p> 
<p>Normal messages will be sent to your bot using the <code>message_received</code> event. In addition, several other events may fire, depending on your implementation and the webhooks you subscribed to within your app's Facebook configuration.</p> 
<table> 
 <thead> 
  <tr> 
   <th>Event</th> 
   <th>Description</th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr> 
   <td>message_received</td> 
   <td>a message was received by the bot</td> 
  </tr> 
  <tr> 
   <td>facebook_postback</td> 
   <td>user clicked a button in an attachment and triggered a webhook postback</td> 
  </tr> 
  <tr> 
   <td>message_delivered</td> 
   <td>a confirmation from Facebook that a message has been received</td> 
  </tr> 
  <tr> 
   <td>facebook_optin</td> 
   <td>a user has clicked the <a href="https://developers.facebook.com/docs/messenger-platform/implementation#send_to_messenger_plugin">Send-to-Messenger plugin</a> </td> 
  </tr> 
 </tbody> 
</table> 
<p>All incoming events will contain the fields <code>user</code> and <code>channel</code>, both of which represent the Facebook user's ID, and a <code>timestamp</code> field.</p> 
<p><code>message_received</code> events will also contain either a <code>text</code> field or an <code>attachment</code> field.</p> 
<p><code>facebook_postback</code> events will contain a <code>payload</code> field.</p> 
<p>More information about the data found in these fields can be found <a href="https://developers.facebook.com/docs/messenger-platform/webhook-reference">here</a>.</p> 
<h2> <a id="user-content-working-with-facebook-messenger" class="anchor" href="#working-with-facebook-messenger" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Working with Facebook Messenger</h2> 
<p>Botkit receives messages from Facebook using webhooks, and sends messages using Facebook's APIs. This means that your bot application must present a web server that is publicly addressable. Everything you need to get started is already included in Botkit.</p> 
<p>To connect your bot to Facebook, <a href="https://developers.facebook.com/docs/messenger-platform/implementation">follow the instructions here</a>. You will need to collect your <code>page token</code> as well as a <code>verify token</code> that you define yourself and configure inside Facebook's app settings. A step by step guide <a href="#getting-started">can be found here</a>. Since you must <em>already be running</em> your Botkit app to configure your Facebook app, there is a bit of back-and-forth. It's ok! You can do it.</p> 
<p>Here is the complete code for a basic Facebook bot:</p> 
<div class="highlight highlight-source-js">
 <pre><span class="pl-k">var</span> Botkit <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>botkit<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> controller <span class="pl-k">=</span> <span class="pl-smi">Botkit</span>.<span class="pl-en">facebookbot</span>({
        access_token<span class="pl-k">:</span> <span class="pl-c1">process</span>.<span class="pl-smi">env</span>.<span class="pl-smi">access_token</span>,
        verify_token<span class="pl-k">:</span> <span class="pl-c1">process</span>.<span class="pl-smi">env</span>.<span class="pl-smi">verify_token</span>,
})

<span class="pl-k">var</span> bot <span class="pl-k">=</span> <span class="pl-smi">controller</span>.<span class="pl-en">spawn</span>({
});

<span class="pl-c">// if you are already using Express, you can use your own server instance...</span>
<span class="pl-c">// see &quot;Use BotKit with an Express web server&quot;</span>
<span class="pl-smi">controller</span>.<span class="pl-en">setupWebserver</span>(<span class="pl-c1">process</span>.<span class="pl-smi">env</span>.<span class="pl-c1">port</span>,<span class="pl-k">function</span>(<span class="pl-smi">err</span>,<span class="pl-smi">webserver</span>) {
  <span class="pl-smi">controller</span>.<span class="pl-en">createWebhookEndpoints</span>(<span class="pl-smi">controller</span>.<span class="pl-smi">webserver</span>, bot, <span class="pl-k">function</span>() {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>This bot is online!!!<span class="pl-pds">'</span></span>);
  });
});

<span class="pl-c">// this is triggered when a user clicks the send-to-messenger plugin</span>
<span class="pl-smi">controller</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>facebook_optin<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">bot</span>, <span class="pl-smi">message</span>) {

    <span class="pl-smi">bot</span>.<span class="pl-en">reply</span>(message, <span class="pl-s"><span class="pl-pds">'</span>Welcome to my app!<span class="pl-pds">'</span></span>);

});

<span class="pl-c">// user said hello</span>
<span class="pl-smi">controller</span>.<span class="pl-en">hears</span>([<span class="pl-s"><span class="pl-pds">'</span>hello<span class="pl-pds">'</span></span>], <span class="pl-s"><span class="pl-pds">'</span>message_received<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">bot</span>, <span class="pl-smi">message</span>) {

    <span class="pl-smi">bot</span>.<span class="pl-en">reply</span>(message, <span class="pl-s"><span class="pl-pds">'</span>Hey there.<span class="pl-pds">'</span></span>);

});

<span class="pl-smi">controller</span>.<span class="pl-en">hears</span>([<span class="pl-s"><span class="pl-pds">'</span>cookies<span class="pl-pds">'</span></span>], <span class="pl-s"><span class="pl-pds">'</span>message_received<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">bot</span>, <span class="pl-smi">message</span>) {

    <span class="pl-smi">bot</span>.<span class="pl-en">startConversation</span>(message, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">convo</span>) {

        <span class="pl-smi">convo</span>.<span class="pl-en">say</span>(<span class="pl-s"><span class="pl-pds">'</span>Did someone say cookies!?!!<span class="pl-pds">'</span></span>);
        <span class="pl-smi">convo</span>.<span class="pl-en">ask</span>(<span class="pl-s"><span class="pl-pds">'</span>What is your favorite type of cookie?<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">response</span>, <span class="pl-smi">convo</span>) {
            <span class="pl-smi">convo</span>.<span class="pl-en">say</span>(<span class="pl-s"><span class="pl-pds">'</span>Golly, I love <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">response</span>.<span class="pl-c1">text</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span> too!!!<span class="pl-pds">'</span></span>);
            <span class="pl-smi">convo</span>.<span class="pl-c1">next</span>();
        });
    });
});</pre>
</div> 
<h4> <a id="user-content-controllersetupwebserver" class="anchor" href="#controllersetupwebserver" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>controller.setupWebserver()</h4> 
<table> 
 <thead> 
  <tr> 
   <th>Argument</th> 
   <th>Description</th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr> 
   <td>port</td> 
   <td>port for webserver</td> 
  </tr> 
  <tr> 
   <td>callback</td> 
   <td>callback function</td> 
  </tr> 
 </tbody> 
</table> 
<p>Setup an <a href="http://expressjs.com/en/index.html">Express webserver</a> for use with <code>createWebhookEndpoints()</code></p> 
<p>If you need more than a simple webserver to receive webhooks, you should by all means create your own Express webserver!</p> 
<p>The callback function receives the Express object as a parameter, which may be used to add further web server routes.</p> 
<h4> <a id="user-content-controllercreatewebhookendpoints" class="anchor" href="#controllercreatewebhookendpoints" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>controller.createWebhookEndpoints()</h4> 
<p>This function configures the route <code>https://_your_server_/facebook/receive</code> to receive webhooks from Facebook.</p> 
<p>This url should be used when configuring Facebook.</p> 
<h2> <a id="user-content-using-structured-messages-and-postbacks" class="anchor" href="#using-structured-messages-and-postbacks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Using Structured Messages and Postbacks</h2> 
<p>You can attach little bubbles</p> 
<p>And in those bubbles can be buttons and when a user clicks the button, it sends a postback with the value.</p> 
<div class="highlight highlight-source-js">
 <pre><span class="pl-smi">controller</span>.<span class="pl-en">hears</span>(<span class="pl-s"><span class="pl-pds">'</span>test<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>message_received<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">bot</span>, <span class="pl-smi">message</span>) {

    <span class="pl-k">var</span> attachment <span class="pl-k">=</span> {
        <span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>template<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>payload<span class="pl-pds">'</span></span><span class="pl-k">:</span>{
            <span class="pl-s"><span class="pl-pds">'</span>template_type<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>generic<span class="pl-pds">'</span></span>,
            <span class="pl-s"><span class="pl-pds">'</span>elements<span class="pl-pds">'</span></span><span class="pl-k">:</span>[
                {
                    <span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>Chocolate Cookie<span class="pl-pds">'</span></span>,
                    <span class="pl-s"><span class="pl-pds">'</span>image_url<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>http://cookies.com/cookie.png<span class="pl-pds">'</span></span>,
                    <span class="pl-s"><span class="pl-pds">'</span>subtitle<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>A delicious chocolate cookie<span class="pl-pds">'</span></span>,
                    <span class="pl-s"><span class="pl-pds">'</span>buttons<span class="pl-pds">'</span></span><span class="pl-k">:</span>[
                        {
                        <span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>postback<span class="pl-pds">'</span></span>,
                        <span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>Eat Cookie<span class="pl-pds">'</span></span>,
                        <span class="pl-s"><span class="pl-pds">'</span>payload<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>chocolate<span class="pl-pds">'</span></span>
                        }
                    ]
                },
            ]
        }
    };

    <span class="pl-smi">bot</span>.<span class="pl-en">reply</span>(message, {
        attachment<span class="pl-k">:</span> attachment,
    });

});

<span class="pl-smi">controller</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>facebook_postback<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">bot</span>, <span class="pl-smi">message</span>) {

    <span class="pl-k">if</span> (<span class="pl-smi">message</span>.<span class="pl-smi">payload</span> <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">'</span>chocolate<span class="pl-pds">'</span></span>) {
        <span class="pl-smi">bot</span>.<span class="pl-en">reply</span>(message, <span class="pl-s"><span class="pl-pds">'</span>You ate the chocolate cookie!<span class="pl-pds">'</span></span>)
    }

});</pre>
</div>
</body>
</html>
